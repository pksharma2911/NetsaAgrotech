<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netsa Agrotech Nursery</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Hind:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2e7d32;
            --secondary: #4caf50;
            --accent: #8bc34a;
            --light: #e8f5e9;
            --white: #ffffff;
            --text: #333333;
            --border: #f44336;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text);
            line-height: 1.6;
            background-color: var(--light);
        }
        
        /* Header with animated logo */
        .header {
            height: 2.5cm;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--primary);
            position: relative;
            overflow: hidden;
        }
        
        .logo-container {
            position: relative;
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .logo {
            font-family: 'Hind', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            text-align: center;
            position: absolute;
            animation: colorChange 8s infinite;
        }
        
        @keyframes colorChange {
            0%, 100% { opacity: 1; color: white; content: "Netsa Agrotech Nursery"; }
            50% { opacity: 1; color: #ffeb3b; content: "नेट्सा एग्रोटेक नर्सरी"; }
        }
        
        /* Navigation */
        .nav-bar {
            height: 1.5cm;
            background-color: var(--secondary);
            display: flex;
            justify-content: center;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .nav-links {
            display: flex;
            gap: 1.5rem;
            overflow-x: auto;
            padding: 0 1rem;
            white-space: nowrap;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            padding: 0.5rem 0;
            position: relative;
        }
        
        .nav-links a:hover::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: white;
        }
        
        /* Main Content */
        .content {
            padding: 2rem;
            min-height: calc(100vh - 2.5cm - 1.5cm - 100px);
        }
        
        /* Pages */
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        /* Home Page */
        .hero-section {
            position: relative;
            height: 400px;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .hero-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://images.unsplash.com/photo-1534710961216-75c88202f43d');
            background-size: cover;
            background-position: center;
            opacity: 0.3;
            z-index: -1;
        }
        
        .tagline {
            font-family: 'Hind', sans-serif;
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }
        
        .tagline-en {
            font-size: 1.5rem;
            color: var(--secondary);
        }
        
        .home-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        /* Gallery */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .gallery-item {
            height: 200px;
            overflow: hidden;
            border-radius: 8px;
            position: relative;
        }
        
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }
        
        /* Order Online */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .product-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .product-img {
            height: 180px;
            overflow: hidden;
        }
        
        .product-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-info {
            padding: 1rem;
        }
        
        /* Review Section */
        #review-slider {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            padding: 10px 0;
        }
        
        #review-slider div {
            min-width: 250px;
            background: #f0f0f0;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        /* Blog Section */
        .blog-posts {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .blog-post {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .blog-post img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .blog-content {
            padding: 1rem;
        }
        
        /* Form Elements */
        input, textarea, select {
            display: block;
            margin: 10px 0;
            padding: 8px;
            width: 100%;
            max-width: 400px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        button {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            font-weight: 600;
        }
        
        button:hover {
            background-color: var(--secondary);
        }
        
        /* Cart */
        #cart {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <!-- Header with Animated Logo -->
    <div class="header">
        <div class="logo-container">
            <div class="logo" id="animated-logo">Netsa Agrotech Nursery</div>
        </div>
    </div>
    
    <!-- Navigation -->
    <div class="nav-bar">
        <div class="nav-links">
            <a href="#" class="nav-link" data-page="home">Home</a>
            <a href="#" class="nav-link" data-page="about">About</a>
            <a href="#" class="nav-link" data-page="contact">Contact Us</a>
            <a href="#" class="nav-link" data-page="gallery">Gallery</a>
            <a href="#" class="nav-link" data-page="vlog">Vlog</a>
            <a href="#" class="nav-link" data-page="blog">Blog</a>
            <a href="#" class="nav-link" data-page="order">Order Online</a>
            <a href="#" class="nav-link" data-page="review">Customer Review</a>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="content">
        <!-- Home Page -->
        <div id="home" class="page active">
            <div class="hero-section">
                <div class="hero-bg"></div>
                <div>
                    <h1 class="tagline">हर घर, हर कोने में हरियाली लाने का हमारा संकल्प</h1>
                    <p class="tagline-en">Bringing Greenery to Your Life</p>
                </div>
            </div>
            <div class="home-content" id="home-data"></div>
        </div>
        
        <!-- About Page -->
        <div id="about" class="page">
            <h2>About Us</h2>
            <p id="about-data">Loading...</p>
        </div>
        
        <!-- Contact Us Page -->
        <div id="contact" class="page">
            <h2>Contact Us</h2>
            <p id="contact-data">Loading...</p>
        </div>
        
        <!-- Gallery Page -->
        <div id="gallery" class="page">
            <h2>Our Gallery</h2>
            <div class="gallery-grid" id="gallery-container"></div>
        </div>
        
        <!-- Vlog Page -->
        <div id="vlog" class="page">
            <h2>Our Vlogs</h2>
            <div id="vlog-container" style="display:flex; flex-wrap:wrap; gap:10px;"></div>
        </div>
        
        <!-- Blog Page -->
        <div id="blog" class="page">
            <h2>Our Blog</h2>
            <div class="blog-posts" id="blog-container"></div>
        </div>
        
        <!-- Order Online Page -->
        <div id="order" class="page">
            <h2>Order Plants Online</h2>
            <div id="product-list" class="products-grid"></div>

            <h3>Your Cart</h3>
            <div id="cart"></div>

            <h3>Checkout</h3>
            <form id="checkout-form">
                <input name="name" placeholder="Customer Name" required>
                <input name="mobile" placeholder="Customer Mobile Number" required>
                <input name="address1" placeholder="Address Line 1" required>
                <input name="address2" placeholder="Address Line 2">
                <input name="locality" placeholder="Locality">
                <input name="tahsil" placeholder="Tahsil">
                <input name="district" placeholder="District">
                <input name="pincode" placeholder="Pin Code">
                <textarea name="orderDetails" placeholder="Order Details" readonly></textarea>
                <button type="submit">Submit Order</button>
            </form>
        </div>
        
        <!-- Customer Review Page -->
        <div id="review" class="page">
            <h2>Customer Reviews</h2>
            <form id="review-form">
                <input name="name" placeholder="Name" required>
                <input name="place" placeholder="Place" required>
                <select name="rating" required>
                    <option value="5">★★★★★</option>
                    <option value="4">★★★★☆</option>
                    <option value="3">★★★☆☆</option>
                    <option value="2">★★☆☆☆</option>
                    <option value="1">★☆☆☆☆</option>
                </select>
                <textarea name="review" placeholder="Write your review here..." required></textarea>
                <button type="submit">Submit Review</button>
            </form>
            <div id="review-slider"></div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer style="background: var(--primary); color: white; text-align: center; padding: 1.5rem;">
        <p>&copy; 2023 Netsa Agrotech Nursery. All rights reserved.</p>
    </footer>

    <script>
        const sheetID = '1WKS54_iCCLmJQJRVNrSTFNvU_A5jNTqhPK1mOlYvT88';
        const scriptURL = 'https://script.google.com/macros/s/AKfycbx3iRoTlH5G16-rDpsR6wptskc2IMS1JoUspcVy0UbenD7IqpQI5Gkwgbi4clABGKak/exec';
        const cart = [];

        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const pageId = link.getAttribute('data-page');
                showPage(pageId);
            });
        });

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // Load content when page is shown
            if (pageId === 'home') loadHome();
            else if (pageId === 'about') loadAbout();
            else if (pageId === 'contact') loadContact();
            else if (pageId === 'gallery') loadGallery();
            else if (pageId === 'vlog') loadVlog();
            else if (pageId === 'blog') loadBlog();
            else if (pageId === 'order') loadProducts();
            else if (pageId === 'review') loadReviews();
        }

        // Load data from Google Sheets
        function loadHome() {
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/Home?alt=json&key=AIzaSyBvyvYuWKeh4_hOrtosELiGvuzNfNSfu4U`)
                .then(r => r.json())
                .then(data => {
                    const homeData = document.getElementById('home-data');
                    homeData.innerHTML = '';
                    
                    // Assuming Column A is English, Column B is Hindi
                    data.values.forEach(row => {
                        if (row[0] && row[1]) {
                            const div = document.createElement('div');
                            div.style.marginBottom = '1rem';
                            div.innerHTML = `
                                <p><strong>${row[0]}</strong></p>
                                <p>${row[1]}</p>
                                <hr style="border-top: 1px solid #ddd; margin: 1rem 0;">
                            `;
                            homeData.appendChild(div);
                        }
                    });
                });
        }

        function loadAbout() {
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/About?alt=json&key=AIzaSyBvyvYuWKeh4_hOrtosELiGvuzNfNSfu4U`)
                .then(r => r.json())
                .then(data => document.getElementById('about-data').innerHTML = 
                    data.values.map(row => `<p>${row.join(' ')}</p>`).join(''));
        }

        function loadContact() {
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/Contact?alt=json&key=AIzaSyBvyvYuWKeh4_hOrtosELiGvuzNfNSfu4U`)
                .then(r => r.json())
                .then(data => document.getElementById('contact-data').innerHTML = 
                    data.values.map(row => `<p>${row.join(' ')}</p>`).join(''));
        }

        function loadGallery() {
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/Gallery?alt=json&key=AIzaSyBvyvYuWKeh4_hOrtosELiGvuzNfNSfu4U`)
                .then(r => r.json())
                .then(data => {
                    const g = document.getElementById('gallery-container');
                    g.innerHTML = '';
                    data.values.forEach(r => {
                        const div = document.createElement('div');
                        div.className = 'gallery-item';
                        const img = document.createElement('img');
                        img.src = r[0];
                        img.alt = 'Nursery plant';
                        div.appendChild(img);
                        g.appendChild(div);
                    });
                });
        }

        function loadVlog() {
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/Vlog?alt=json&key=AIzaSyBvyvYuWKeh4_hOrtosELiGvuzNfNSfu4U`)
                .then(r => r.json())
                .then(data => {
                    const v = document.getElementById('vlog-container');
                    v.innerHTML = '';
                    data.values.forEach(r => {
                        const iframe = document.createElement('iframe');
                        iframe.src = r[1];
                        iframe.width = 250;
                        iframe.height = 150;
                        iframe.allow = 'autoplay';
                        v.appendChild(iframe);
                    });
                });
        }

        function loadBlog() {
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/Blog?alt=json&key=AIzaSyBvyvYuWKeh4_hOrtosELiGvuzNfNSfu4U`)
                .then(r => r.json())
                .then(data => {
                    const rows = data.values.slice(1); // Skip header row
                    const blogContainer = document.getElementById('blog-container');
                    blogContainer.innerHTML = '';
                    
                    rows.forEach(row => {
                        const blogPost = document.createElement('div');
                        blogPost.className = 'blog-post';
                        
                        blogPost.innerHTML = `
                            ${row[2] ? `<img src="${row[2]}" alt="${row[0]}">` : ''}
                            <div class="blog-content">
                                <h3>${row[0]}</h3>
                                <small>${row[1]}</small>
                                <p>${row[3]}</p>
                            </div>
                        `;
                        
                        blogContainer.appendChild(blogPost);
                    });
                });
        }

        function loadProducts() {
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/SKU?alt=json&key=AIzaSyBvyvYuWKeh4_hOrtosELiGvuzNfNSfu4U`)
                .then(r => r.json())
                .then(data => {
                    const rows = data.values.slice(1);
                    document.getElementById('product-list').innerHTML = rows.map((r, i) => `
                        <div class="product-card">
                            <div class="product-img">
                                <img src="${r[3]}" alt="${r[1]}">
                            </div>
                            <div class="product-info">
                                <h4>${r[1]} (${r[0]})</h4>
                                <p>Rate: ₹${r[2]}</p>
                                <div style="display:flex; align-items:center; gap:10px;">
                                    Qty: <input type="number" id="qty-${i}" min="1" value="1" style="width:50px">
                                    <button onclick="addToCart('${r[0]}','${r[1]}',${r[2]},'qty-${i}')">Add to Cart</button>
                                </div>
                            </div>
                        </div>`).join('');
                });
        }

        function addToCart(cat, name, rate, qtyID) {
            const qty = parseInt(document.getElementById(qtyID).value);
            if (qty > 0) {
                cart.push({ cat, name, rate, qty });
                renderCart();
            }
        }

        function renderCart() {
            let total = 0;
            let summary = '';
            let html = '<ul>';
            cart.forEach(item => {
                const amount = item.qty * item.rate;
                total += amount;
                html += `<li>${item.name} x ${item.qty} = ₹${amount}</li>`;
                summary += `${item.name} (${item.qty}) - ₹${amount}\n`;
            });
            html += `</ul><b>Total: ₹${total}</b>`;
            document.getElementById('cart').innerHTML = html;
            document.querySelector('textarea[name="orderDetails"]').value = summary;
        }

        function loadReviews() {
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/Review?alt=json&key=AIzaSyBvyvYuWKeh4_hOrtosELiGvuzNfNSfu4U`)
                .then(r => r.json())
                .then(data => {
                    const rows = data.values.slice(1).reverse();
                    document.getElementById('review-slider').innerHTML = rows.map(r => {
                        const stars = '★'.repeat(+r[2]) + '☆'.repeat(5 - +r[2]);
                        return `<div><h4>${r[0]} <small>(${r[1]})</small></h4><p style="color:orange;">${stars}</p><p>"${r[3]}"</p></div>`;
                    }).join('');
                });
        }

        // Form submissions
        document.getElementById('checkout-form').addEventListener('submit', e => {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            // Convert FormData to plain object
            const data = {};
            formData.forEach((value, key) => {
                data[key] = value;
            });
            
            // Add cart items and metadata
            data.sheetName = 'Order';
            data.action = 'addOrder';
            data.cartItems = JSON.stringify(cart);
            
            fetch(scriptURL, { 
                method: 'POST', 
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(r => {
                if (!r.ok) throw new Error('Network response was not ok');
                return r.text();
            })
            .then(() => {
                alert('Order submitted successfully!');
                e.target.reset(); 
                cart.length = 0; 
                renderCart();
                
                // Send email after successful submission
                sendOrderEmail(data);
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error submitting order: ' + error.message);
            });
        });

        document.getElementById('review-form').addEventListener('submit', e => {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            // Convert FormData to plain object
            const data = {};
            formData.forEach((value, key) => {
                data[key] = value;
            });
            
            // Add metadata for Google Sheets
            data.sheetName = 'Review';
            data.action = 'addReview';
            
            fetch(scriptURL, { 
                method: 'POST', 
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(r => {
                if (!r.ok) throw new Error('Network response was not ok');
                return r.text();
            })
            .then(() => {
                alert('Review submitted successfully!');
                e.target.reset(); 
                loadReviews();
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error submitting review: ' + error.message);
            });
        });

        function sendOrderEmail(orderData) {
            // Get contact email from your contact data
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/Contact?alt=json&key=AIzaSyBvyvYuWKeh4_hOrtosELiGvuzNfNSfu4U`)
                .then(r => r.json())
                .then(data => {
                    const contactInfo = data.values.find(row => row[0].includes('Email'));
                    const email = contactInfo ? contactInfo[1] : 'your-default-email@example.com';
                    
                    // Prepare email data
                    const emailData = {
                        action: 'sendEmail',
                        to: email,
                        subject: `New Order from ${orderData.name}`,
                        body: `New Order Details:
                        
Customer: ${orderData.name}
Mobile: ${orderData.mobile}
Address: ${orderData.address1}, ${orderData.address2}
${orderData.locality}, ${orderData.tahsil}, ${orderData.district}
Pincode: ${orderData.pincode}

Order Items:
${orderData.orderDetails}

Total: ₹${cart.reduce((sum, item) => sum + (item.qty * item.rate), 0)}
`
                    };
                    
                    // Send email request
                    return fetch(scriptURL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(emailData)
                    });
                })
                .then(r => {
                    if (!r.ok) throw new Error('Email sending failed');
                    console.log('Email sent successfully');
                })
                .catch(error => {
                    console.error('Email error:', error);
                    // Fail silently - order was still recorded
                });
        }

        // Animate logo between English and Hindi
        let isHindi = false;
        setInterval(() => {
            isHindi = !isHindi;
            document.getElementById('animated-logo').textContent = isHindi ? 'नेट्सा एग्रोटेक नर्सरी' : 'Netsa Agrotech Nursery';
        }, 4000);

        // Initialize
        loadHome();
        loadAbout();
        loadContact();
        loadGallery();
        loadVlog();
        loadBlog();
        loadProducts();
        loadReviews();
    </script>
</body>
</html>